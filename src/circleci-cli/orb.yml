version: 2.1
commands:
  install:
    parameters:
      token-env-var:
        type: string
        default: ""
    steps:
      - run:
          name: "Install `circleci` CLI"
          command: |
            sudo bash -c "$(curl -fSl https://raw.githubusercontent.com/CircleCI-Public/circleci-cli/master/install.sh)"
            echo "Print the circleci version"
            circleci version
            echo "Run circleci help"
            circleci help
            echo -e "token: $<< parameters.token-env-var >>\nverbose: false" > ~/.circleci/cli.yml
executors:
  default:
    description:
      Uses the circleci-cli image, which includes the `circleci` command.
    parameters:
      tag:
        type: string
        default: "latest"
    docker:
      - image: circleci/circleci-cli:<< parameters.tag >>
